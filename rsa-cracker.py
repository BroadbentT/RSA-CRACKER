#!/usr/bin/python

# -------------------------------------------------------------------------------------
#                      PYTHON UTILITY FILE TO CRACK RSA FILES
#                BY TERENCE BROADBENT BSC CYBER SECURITY (FIRST CLASS)
# -------------------------------------------------------------------------------------

# ------------------------------------------------------------------------------------- 
# AUTHOR  : Terence Broadbent                                                    
# CONTRACT: GitHub
# Version : 1.0                                                                
# Details : Load any required imports.
# Modified: N/A
# -------------------------------------------------------------------------------------

import binascii

# -------------------------------------------------------------------------------------
# AUTHOR  : Terence Broadbent                                                    
# CONTRACT: GitHub
# Version : 1.0                                                                
# Details : Show a universal header.    
# Modified: N/A                                                               
# -------------------------------------------------------------------------------------

print " ____  ____    _       ____ ____      _    ____ _  _______ ____   "
print "|  _ \/ ___|  / \     / ___|  _ \    / \  / ___| |/ / ____|  _ \  "
print "| |_) \___ \ / _ \   | |   | |_) |  / _ \| |   | ' /|  _| | |_) | "
print "|  _ < ___) / ___ \  | |___|  _ <  / ___ \ |___| . \| |___|  _ <  "
print "|_| \_\____/_/   \_\  \____|_| \_\/_/   \_\____|_|\_\_____|_| \_\ "
print "                                                                  "
print "      BY TERENCE BROADBENT BSC CYBER SECURITY (FIRST CLASS)       "
print "\n"

# -------------------------------------------------------------------------------------
# AUTHOR  : Terence Broadbent                                                    
# CONTRACT: GitHub
# Version : 1.0                                                                
# Details : Setup the RSA requirements as defined below.
# Modified: N/A                                                               
# -------------------------------------------------------------------------------------
print "                           Required\n"
print "<Message>...</Message>      [yes]\n"

print "<RSAKeyValue>"
print "   <Modulus>...</Modulus>   [no]"
print "   <Exponent>...</Exponent>"
print "   <P>...</P>               [yes]" 
print "   <Q>...</Q>               [yes]"
print "   <DP>...</DP>             [yes]"
print "   <DQ>...</DQ>             [yes]"
print "   <InverseQ>...</InverseQ> [calculated]" 
print "   <D>...</D>               [no]"
print "</RSAKeyValue>"

c=62078086677416686867183857957350338314446280912673392448065026850212685326551183962056495964579782325302082054393933682265772802750887293602432512967994805549965020916953644635965916607925335639027579187435180607475963322465417758959002385451863122106487834784688029167720175128082066670945625067803812970871
p=7901324502264899236349230781143813838831920474669364339844939631481665770635584819958931021644265960578585153616742963330195946431321644921572803658406281
q=12802918451444044622583757703752066118180068668479378778928741088302355425977192996799623998720429594346778865275391307730988819243843851683079000293815051
dp=5540655028622021934429306287937775291955623308965208384582009857376053583575510784169616065113641391169613969813652523507421157045377898542386933198269451
dq=9066897320308834206952359399737747311983309062764178906269475847173966073567988170415839954996322314157438770225952491560052871464136163421892050057498651
iq=0
d=0

# -------------------------------------------------------------------------------------
# AUTHOR  : Terence Broadbent                                                    
# CONTRACT: GitHub
# Version : 1.0                                                                
# Details : Calculate what is missing from the RSA formula.
# Modified: N/A                                                               
# -------------------------------------------------------------------------------------

iq = (1/q) % p

# -------------------------------------------------------------------------------------
# AUTHOR  : Terence Broadbent                                                    
# CONTRACT: GitHub
# Version : 1.0                                                                
# Details : Calculate secret message, and convert it to ascii format.
# Modified: N/A                                                               
# -------------------------------------------------------------------------------------

m2 = pow(c, dq, q)
message = binascii.unhexlify(format(m2, 'x')).decode()
print "\n<Message> " + message + " </Message>\n\n"

#Eof

